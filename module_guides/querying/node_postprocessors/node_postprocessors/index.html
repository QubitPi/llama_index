
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.llamaindex.ai/en/stable/module_guides/querying/node_postprocessors/node_postprocessors/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../response_synthesizers/">
      
      
      <link rel="icon" href="../../../../_static/assets/LlamaLogoBrowserTab.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Node Postprocessor Modules - LlamaIndex</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../css/style.css">
    
      <link rel="stylesheet" href="../../../../css/algolia.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-BYVB1ZVE6J"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-BYVB1ZVE6J",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-BYVB1ZVE6J",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#node-postprocessor-modules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="LlamaIndex" class="md-header__button md-logo" aria-label="LlamaIndex" data-md-component="logo">
      
  <img src="../../../../_static/assets/LlamaSquareBlack.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LlamaIndex
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Node Postprocessor Modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="purple"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        

<!-- Search interface -->
<div id="docsearch"></div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../understanding/" class="md-tabs__link">
          
  
  
    
  
  Learn

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../use_cases/" class="md-tabs__link">
          
  
  
    
  
  Use Cases

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  
    
  
  Component Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../optimizing/production_rag/" class="md-tabs__link">
          
  
  
    
  
  Advanced Topics

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../api_reference/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../community/integrations/" class="md-tabs__link">
          
  
  
    
  
  Open-Source Community

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../llama_cloud/" class="md-tabs__link">
          
  
  
    
  
  LlamaCloud

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="LlamaIndex" class="md-nav__button md-logo" aria-label="LlamaIndex" data-md-component="logo">
      
  <img src="../../../../_static/assets/LlamaSquareBlack.svg" alt="logo">

    </a>
    LlamaIndex
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../.." class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../understanding/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Learn
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../use_cases/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Use Cases
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../examples/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Component Guides
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Component Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../models/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Models
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../models/prompts/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Prompts
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../loading/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Loading
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../indexing/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Indexing
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../storing/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Storing
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Querying
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Querying
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../deploying/query_engine/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Query Engines
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../deploying/chat_engines/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Chat Engines
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../retriever/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Retrieval
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Node Postprocessors
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_7_5" id="__nav_5_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_7_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_7_5">
            <span class="md-nav__icon md-icon"></span>
            Node Postprocessors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Node Postprocessor Modules
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Node Postprocessor Modules
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#similaritypostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      SimilarityPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#keywordnodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      KeywordNodePostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadatareplacementpostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      MetadataReplacementPostProcessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#longcontextreorder" class="md-nav__link">
    <span class="md-ellipsis">
      LongContextReorder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sentenceembeddingoptimizer" class="md-nav__link">
    <span class="md-ellipsis">
      SentenceEmbeddingOptimizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coherererank" class="md-nav__link">
    <span class="md-ellipsis">
      CohereRerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sentencetransformerrerank" class="md-nav__link">
    <span class="md-ellipsis">
      SentenceTransformerRerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#llm-rerank" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Rerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jinarerank" class="md-nav__link">
    <span class="md-ellipsis">
      JinaRerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixedrecencypostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      FixedRecencyPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embeddingrecencypostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      EmbeddingRecencyPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeweightedpostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      TimeWeightedPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-piinodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) PIINodePostprocessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="(Beta) PIINodePostprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#llm-version" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ner-version" class="md-nav__link">
    <span class="md-ellipsis">
      NER Version
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-prevnextnodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) PrevNextNodePostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-autoprevnextnodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) AutoPrevNextNodePostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-rankgpt" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) RankGPT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#colbert-reranker" class="md-nav__link">
    <span class="md-ellipsis">
      Colbert Reranker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rankllm" class="md-nav__link">
    <span class="md-ellipsis">
      rankLLM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      All Notebooks
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../response_synthesizers/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Response Synthesis
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../router/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Routing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../pipeline/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Query Pipelines (Deprecated)
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../structured_outputs/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Structured Outputs
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../deploying/agents/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Agents
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../workflow/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Workflows
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../evaluating/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Evaluation
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../observability/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Observability
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../supporting_modules/settings/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../llama_deploy" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Llama Deploy
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../optimizing/production_rag/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Advanced Topics
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../api_reference/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../community/integrations/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Open-Source Community
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../../../llama_cloud/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    LlamaCloud
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#similaritypostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      SimilarityPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#keywordnodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      KeywordNodePostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadatareplacementpostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      MetadataReplacementPostProcessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#longcontextreorder" class="md-nav__link">
    <span class="md-ellipsis">
      LongContextReorder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sentenceembeddingoptimizer" class="md-nav__link">
    <span class="md-ellipsis">
      SentenceEmbeddingOptimizer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coherererank" class="md-nav__link">
    <span class="md-ellipsis">
      CohereRerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sentencetransformerrerank" class="md-nav__link">
    <span class="md-ellipsis">
      SentenceTransformerRerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#llm-rerank" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Rerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jinarerank" class="md-nav__link">
    <span class="md-ellipsis">
      JinaRerank
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixedrecencypostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      FixedRecencyPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#embeddingrecencypostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      EmbeddingRecencyPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#timeweightedpostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      TimeWeightedPostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-piinodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) PIINodePostprocessor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="(Beta) PIINodePostprocessor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#llm-version" class="md-nav__link">
    <span class="md-ellipsis">
      LLM Version
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ner-version" class="md-nav__link">
    <span class="md-ellipsis">
      NER Version
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-prevnextnodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) PrevNextNodePostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-autoprevnextnodepostprocessor" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) AutoPrevNextNodePostprocessor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#beta-rankgpt" class="md-nav__link">
    <span class="md-ellipsis">
      (Beta) RankGPT
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#colbert-reranker" class="md-nav__link">
    <span class="md-ellipsis">
      Colbert Reranker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rankllm" class="md-nav__link">
    <span class="md-ellipsis">
      rankLLM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-notebooks" class="md-nav__link">
    <span class="md-ellipsis">
      All Notebooks
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="node-postprocessor-modules">Node Postprocessor Modules<a class="headerlink" href="#node-postprocessor-modules" title="Permanent link">#</a></h1>
<h2 id="similaritypostprocessor">SimilarityPostprocessor<a class="headerlink" href="#similaritypostprocessor" title="Permanent link">#</a></h2>
<p>Used to remove nodes that are below a similarity score threshold.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">SimilarityPostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">SimilarityPostprocessor</span><span class="p">(</span><span class="n">similarity_cutoff</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<h2 id="keywordnodepostprocessor">KeywordNodePostprocessor<a class="headerlink" href="#keywordnodepostprocessor" title="Permanent link">#</a></h2>
<p>Used to ensure certain keywords are either excluded or included.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">KeywordNodePostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">KeywordNodePostprocessor</span><span class="p">(</span>
    <span class="n">required_keywords</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;word1&quot;</span><span class="p">,</span> <span class="s2">&quot;word2&quot;</span><span class="p">],</span> <span class="n">exclude_keywords</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;word3&quot;</span><span class="p">,</span> <span class="s2">&quot;word4&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<h2 id="metadatareplacementpostprocessor">MetadataReplacementPostProcessor<a class="headerlink" href="#metadatareplacementpostprocessor" title="Permanent link">#</a></h2>
<p>Used to replace the node content with a field from the node metadata. If the field is not present in the metadata, then the node text remains unchanged. Most useful when used in combination with the <code>SentenceWindowNodeParser</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">MetadataReplacementPostProcessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">MetadataReplacementPostProcessor</span><span class="p">(</span>
    <span class="n">target_metadata_key</span><span class="o">=</span><span class="s2">&quot;window&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<h2 id="longcontextreorder">LongContextReorder<a class="headerlink" href="#longcontextreorder" title="Permanent link">#</a></h2>
<p>Models struggle to access significant details found in the center of extended contexts. <a href="https://arxiv.org/abs/2307.03172">A study</a> observed that the best performance typically arises when crucial data is positioned at the start or conclusion of the input context. Additionally, as the input context lengthens, performance drops notably, even in models designed for long contexts.</p>
<p>This module will re-order the retrieved nodes, which can be helpful in cases where a large top-k is needed.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">LongContextReorder</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">LongContextReorder</span><span class="p">()</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<h2 id="sentenceembeddingoptimizer">SentenceEmbeddingOptimizer<a class="headerlink" href="#sentenceembeddingoptimizer" title="Permanent link">#</a></h2>
<p>This postprocessor optimizes token usage by removing sentences that are not relevant to the query (this is done using embeddings).</p>
<p>The percentile cutoff is a measure for using the top percentage of relevant sentences.</p>
<p>The threshold cutoff can be specified instead, which uses a raw similarity cutoff for picking which sentences to keep.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">SentenceEmbeddingOptimizer</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">SentenceEmbeddingOptimizer</span><span class="p">(</span>
    <span class="n">embed_model</span><span class="o">=</span><span class="n">service_context</span><span class="o">.</span><span class="n">embed_model</span><span class="p">,</span>
    <span class="n">percentile_cutoff</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="c1"># threshold_cutoff=0.7</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>A full notebook guide can be found <a href="../../../../examples/node_postprocessor/OptimizerDemo/">here</a></p>
<h2 id="coherererank">CohereRerank<a class="headerlink" href="#coherererank" title="Permanent link">#</a></h2>
<p>Uses the "Cohere ReRank" functionality to re-order nodes, and returns the top N nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.postprocessor.cohere_rerank</span> <span class="kn">import</span> <span class="n">CohereRerank</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">CohereRerank</span><span class="p">(</span>
    <span class="n">top_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;rerank-english-v2.0&quot;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;YOUR COHERE API KEY&quot;</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>Full notebook guide is available <a href="../../../../examples/node_postprocessor/CohereRerank/">here</a>.</p>
<h2 id="sentencetransformerrerank">SentenceTransformerRerank<a class="headerlink" href="#sentencetransformerrerank" title="Permanent link">#</a></h2>
<p>Uses the cross-encoders from the <code>sentence-transformer</code> package to re-order nodes, and returns the top N nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">SentenceTransformerRerank</span>

<span class="c1"># We choose a model with relatively high speed and decent accuracy.</span>
<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">SentenceTransformerRerank</span><span class="p">(</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;cross-encoder/ms-marco-MiniLM-L-2-v2&quot;</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>Full notebook guide is available <a href="../../../../examples/node_postprocessor/SentenceTransformerRerank/">here</a>.</p>
<p>Please also refer to the <a href="https://www.sbert.net/docs/pretrained-models/ce-msmarco.html"><code>sentence-transformer</code> docs</a> for a more complete list of models (and also shows tradeoffs in speed/accuracy). The default model is <code>cross-encoder/ms-marco-TinyBERT-L-2-v2</code>, which provides the most speed.</p>
<h2 id="llm-rerank">LLM Rerank<a class="headerlink" href="#llm-rerank" title="Permanent link">#</a></h2>
<p>Uses a LLM to re-order nodes by asking the LLM to return the relevant documents and a score of how relevant they are. Returns the top N ranked nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">LLMRerank</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">LLMRerank</span><span class="p">(</span><span class="n">top_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">service_context</span><span class="o">=</span><span class="n">service_context</span><span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>Full notebook guide is available <a href="../../../../examples/node_postprocessor/LLMReranker-Gatsby/">her for Gatsby</a> and <a href="../../../../examples/node_postprocessor/LLMReranker-Lyft-10k/">here for Lyft 10K documents</a>.</p>
<h2 id="jinarerank">JinaRerank<a class="headerlink" href="#jinarerank" title="Permanent link">#</a></h2>
<p>Uses the "Jina ReRank" functionality to re-order nodes, and returns the top N nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.postprocessor.jinaai_rerank</span> <span class="kn">import</span> <span class="n">JinaRerank</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">JinaRerank</span><span class="p">(</span>
    <span class="n">top_n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;jina-reranker-v1-base-en&quot;</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;YOUR JINA API KEY&quot;</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>Full notebook guide is available <a href="../../../../examples/node_postprocessor/JinaRerank/">here</a>.</p>
<h2 id="fixedrecencypostprocessor">FixedRecencyPostprocessor<a class="headerlink" href="#fixedrecencypostprocessor" title="Permanent link">#</a></h2>
<p>This postprocessor returns the top K nodes sorted by date. This assumes there is a <code>date</code> field to parse in the metadata of each node.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">FixedRecencyPostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">FixedRecencyPostprocessor</span><span class="p">(</span>
    <span class="n">tok_k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">date_key</span><span class="o">=</span><span class="s2">&quot;date&quot;</span>  <span class="c1"># the key in the metadata to find the date</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="../../../../_static/node_postprocessors/recency.png" /></p>
<p>A full notebook guide is available <a href="../../../../examples/node_postprocessor/RecencyPostprocessorDemo/">here</a>.</p>
<h2 id="embeddingrecencypostprocessor">EmbeddingRecencyPostprocessor<a class="headerlink" href="#embeddingrecencypostprocessor" title="Permanent link">#</a></h2>
<p>This postprocessor returns the top K nodes after sorting by date and removing older nodes that are too similar after measuring embedding similarity.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">EmbeddingRecencyPostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">EmbeddingRecencyPostprocessor</span><span class="p">(</span>
    <span class="n">service_context</span><span class="o">=</span><span class="n">service_context</span><span class="p">,</span> <span class="n">date_key</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span> <span class="n">similarity_cutoff</span><span class="o">=</span><span class="mf">0.7</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>A full notebook guide is available <a href="../../../../examples/node_postprocessor/RecencyPostprocessorDemo/">here</a>.</p>
<h2 id="timeweightedpostprocessor">TimeWeightedPostprocessor<a class="headerlink" href="#timeweightedpostprocessor" title="Permanent link">#</a></h2>
<p>This postprocessor returns the top K nodes applying a time-weighted rerank to each node. Each time a node is retrieved, the time it was retrieved is recorded. This biases search to favor information that has not been returned in a query yet.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">TimeWeightedPostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">TimeWeightedPostprocessor</span><span class="p">(</span><span class="n">time_decay</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">top_k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>A full notebook guide is available <a href="../../../../examples/node_postprocessor/TimeWeightedPostprocessorDemo/">here</a>.</p>
<h2 id="beta-piinodepostprocessor">(Beta) PIINodePostprocessor<a class="headerlink" href="#beta-piinodepostprocessor" title="Permanent link">#</a></h2>
<p>The PII (Personal Identifiable Information) postprocessor removes information that might be a security risk. It does this by using NER (either with a dedicated NER model, or with a local LLM model).</p>
<h3 id="llm-version">LLM Version<a class="headerlink" href="#llm-version" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">PIINodePostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">PIINodePostprocessor</span><span class="p">(</span>
    <span class="n">service_context</span><span class="o">=</span><span class="n">service_context</span>  <span class="c1"># this should be setup with an LLM you trust</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<h3 id="ner-version">NER Version<a class="headerlink" href="#ner-version" title="Permanent link">#</a></h3>
<p>This version uses the default local model from Hugging Face that is loaded when you run <code>pipeline("ner")</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">NERPIINodePostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">NERPIINodePostprocessor</span><span class="p">()</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>A full notebook guide for both can be found <a href="../../../../examples/node_postprocessor/PII/">here</a>.</p>
<h2 id="beta-prevnextnodepostprocessor">(Beta) PrevNextNodePostprocessor<a class="headerlink" href="#beta-prevnextnodepostprocessor" title="Permanent link">#</a></h2>
<p>Uses pre-defined settings to read the <code>Node</code> relationships and fetch either all nodes that come previously, next, or both.</p>
<p>This is useful when you know the relationships point to important data (either before, after, or both) that should be sent to the LLM if that node is retrieved.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">PrevNextNodePostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">PrevNextNodePostprocessor</span><span class="p">(</span>
    <span class="n">docstore</span><span class="o">=</span><span class="n">index</span><span class="o">.</span><span class="n">docstore</span><span class="p">,</span>
    <span class="n">num_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># number of nodes to fetch when looking forwards or backwards</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;next&quot;</span><span class="p">,</span>  <span class="c1"># can be either &#39;next&#39;, &#39;previous&#39;, or &#39;both&#39;</span>
<span class="p">)</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p><img alt="" src="../../../../_static/node_postprocessors/prev_next.png" /></p>
<h2 id="beta-autoprevnextnodepostprocessor">(Beta) AutoPrevNextNodePostprocessor<a class="headerlink" href="#beta-autoprevnextnodepostprocessor" title="Permanent link">#</a></h2>
<p>The same as PrevNextNodePostprocessor, but lets the LLM decide the mode (next, previous, or both).</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.core.postprocessor</span> <span class="kn">import</span> <span class="n">AutoPrevNextNodePostprocessor</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">AutoPrevNextNodePostprocessor</span><span class="p">(</span>
    <span class="n">docstore</span><span class="o">=</span><span class="n">index</span><span class="o">.</span><span class="n">docstore</span><span class="p">,</span>
    <span class="n">service_context</span><span class="o">=</span><span class="n">service_context</span><span class="p">,</span>
    <span class="n">num_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># number of nodes to fetch when looking forwards or backwards)</span>
<span class="p">)</span>
<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>A full example notebook is available <a href="../../../../examples/node_postprocessor/PrevNextPostprocessorDemo/">here</a>.</p>
<h2 id="beta-rankgpt">(Beta) RankGPT<a class="headerlink" href="#beta-rankgpt" title="Permanent link">#</a></h2>
<p>Uses RankGPT agent to rerank documents according to relevance. Returns the top N ranked nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.postprocessor.rankgpt_rerank</span> <span class="kn">import</span> <span class="n">RankGPTRerank</span>

<span class="n">postprocessor</span> <span class="o">=</span> <span class="n">RankGPTRerank</span><span class="p">(</span><span class="n">top_n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="n">OpenAI</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo-16k&quot;</span><span class="p">))</span>

<span class="n">postprocessor</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>Full notebook guide is available <a href="../../../../examples/node_postprocessor/rankGPT/">here</a>.</p>
<h2 id="colbert-reranker">Colbert Reranker<a class="headerlink" href="#colbert-reranker" title="Permanent link">#</a></h2>
<p>Uses Colbert V2 model as a reranker to rerank documents according to the fine-grained similarity between query tokens and passage tokens. Returns the top N ranked nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.postprocessor.colbert_rerank</span> <span class="kn">import</span> <span class="n">ColbertRerank</span>

<span class="n">colbert_reranker</span> <span class="o">=</span> <span class="n">ColbertRerank</span><span class="p">(</span>
    <span class="n">top_n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="s2">&quot;colbert-ir/colbertv2.0&quot;</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="s2">&quot;colbert-ir/colbertv2.0&quot;</span><span class="p">,</span>
    <span class="n">keep_retrieval_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">query_engine</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">as_query_engine</span><span class="p">(</span>
    <span class="n">similarity_top_k</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">node_postprocessors</span><span class="o">=</span><span class="p">[</span><span class="n">colbert_reranker</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">query_engine</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="n">query_str</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
<p>Full notebook guide is available <a href="../../../../examples/node_postprocessor/ColbertRerank/">here</a>.</p>
<h2 id="rankllm">rankLLM<a class="headerlink" href="#rankllm" title="Permanent link">#</a></h2>
<p>Uses models from <a href="https://github.com/castorini/rank_llm">rankLLM</a> to rerank documents. Returns the top N ranked nodes.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">llama_index.postprocessor.rankllm_rerank</span> <span class="kn">import</span> <span class="n">RankLLMRerank</span>

<span class="c1"># RankZephyr reranker, return top 5 candidates</span>
<span class="n">reranker</span> <span class="o">=</span> <span class="n">RankLLMRerank</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;rank_zephyr&quot;</span><span class="p">,</span> <span class="n">top_n</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">reranker</span><span class="o">.</span><span class="n">postprocess_nodes</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
</code></pre></div>
<p>A full <a href="../../../../examples/node_postprocessor/rankLLM/">notebook example is available</a>.</p>
<h2 id="all-notebooks">All Notebooks<a class="headerlink" href="#all-notebooks" title="Permanent link">#</a></h2>
<ul>
<li><a href="../../../../examples/node_postprocessor/OptimizerDemo/">Sentence Optimizer</a></li>
<li><a href="../../../../examples/node_postprocessor/CohereRerank/">Cohere Rerank</a></li>
<li><a href="../../../../examples/node_postprocessor/LLMReranker-Lyft-10k/">LLM Reranker Lyft 10k</a></li>
<li><a href="../../../../examples/node_postprocessor/LLMReranker-Gatsby/">LLM Reranker Gatsby</a></li>
<li><a href="../../../../examples/node_postprocessor/RecencyPostprocessorDemo/">Recency</a></li>
<li><a href="../../../../examples/node_postprocessor/TimeWeightedPostprocessorDemo/">Time Weighted</a></li>
<li><a href="../../../../examples/node_postprocessor/PII/">PII</a></li>
<li><a href="../../../../examples/node_postprocessor/PrevNextPostprocessorDemo/">PrevNext</a></li>
<li><a href="../../../../examples/node_postprocessor/MetadataReplacementDemo/">Metadata Replacement</a></li>
<li><a href="../../../../examples/node_postprocessor/LongContextReorder/">Long Context Reorder</a></li>
<li><a href="../../../../examples/node_postprocessor/rankGPT/">RankGPT</a></li>
<li><a href="../../../../examples/node_postprocessor/ColbertRerank/">Colbert Rerank</a></li>
<li><a href="../../../../examples/node_postprocessor/JinaRerank/">JinaAI Rerank</a></li>
<li><a href="../../../../examples/cookbooks/mixedbread_reranker/">MixedBread Rerank</a></li>
<li><a href="../../../../examples/node_postprocessor/rankLLM/">RankLLM</a></li>
</ul>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
       
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Node Postprocessor">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Node Postprocessor
              </div>
            </div>
          </a>
        
        
          
          <a href="../../response_synthesizers/" class="md-footer__link md-footer__link--next" aria-label="Next: Response Synthesizer">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Response Synthesizer
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <readthedocs-flyout position="bottom-left"></readthedocs-flyout>
      
    </div>
  </div>
</footer>
      
<!-- Google Tag Manager -->
<script>
  (function (w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
    var f = d.getElementsByTagName(s)[0],
      j = d.createElement(s),
      dl = l != "dataLayer" ? "&l=" + l : "";
    j.async = true;
    j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
    f.parentNode.insertBefore(j, f);
  })(window, document, "script", "dataLayer", "GTM-WWRFB36R");
</script>
<!-- End Google Tag Manager -->

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.prune", "navigation.tabs", "navigation.indexes", "navigation.top", "navigation.footer", "toc.follow", "content.code.copy", "search.suggest", "search.highlight"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../../javascript/runllm.js"></script>
      
        <script src="../../../../javascript/algolia.js"></script>
      
    
  </body>
</html>